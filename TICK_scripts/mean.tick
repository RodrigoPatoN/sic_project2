stream
    |from()
        .database('weather')
        .retentionPolicy('autogen')
        .measurement('weatherMesasurement')
    |window()
        .period(30s)
        .every(1s)
    |mean('temperature')
        .as('temperature')
    |alert()
        .crit(lambda: "temperature" > -100)
        .message('{{index .Fields "temperature"}}')
        .mqtt('kapacitor')
        .qos(1)
        .retained(TRUE)
    |log()
